(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{u3dW:function(e,t,r){"use strict";r.r(t),r.d(t,"ChooseBusinessModule",(function(){return x}));var i=r("2kYt"),s=r("47kq"),n=r("D/wg"),a=r("sEIs"),c=r("42YS"),o=r("vIZi"),p=r("81ol"),u=r("q6bj"),h=r("pJFc"),l=r("XZLj"),d=r("ke9K"),b=r("8lHc"),f=r("5uDM"),v=r("YtkY"),m=r("EM62"),y=r("j51s");let g=(()=>{class e{constructor(e,t,r,i,s){this.backService=e,this.apQuery=t,this.configQuery=r,this.flow=i,this.isamApi=s}ngOnInit(){this.apName=this.apQuery.providerName,this.flow.updateAp("selection",h.k.Completed),this.backService.setBackLocation("/choose-business/selection"),Object(b.a)(this.configQuery.redirectTimeout).pipe(Object(f.a)(()=>this.retrieveBusinessInfo()),Object(v.a)(e=>this.externalRedirect(e))).subscribe()}externalRedirect(e){const t=e.headers.get("location");t?window.location.href=t:console.error("No redirection location provided")}retrieveBusinessInfo(){return this.isamApi.retrieveAttributeProviderDetails(this.apQuery.apAuthId)}}return e.\u0275fac=function(t){return new(t||e)(m.Pb(l.a),m.Pb(d.a),m.Pb(p.b),m.Pb(u.f),m.Pb(o.d))},e.\u0275cmp=m.Jb({type:e,selectors:[["exchange-choose-business"]],decls:1,vars:1,consts:[[3,"name"]],template:function(e,t){1&e&&m.Qb(0,"app-generic-redirect",0),2&e&&m.mc("name",t.apName)},directives:[y.a],styles:[""]}),e})(),A=(()=>{class e{constructor(e){this.rp=e}canActivate(){return!!this.rp.hasScope("tdif_business_authorisations")}}return e.\u0275fac=function(t){return new(t||e)(m.Zb(d.k))},e.\u0275prov=m.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=r("ROBh"),k=r("fN3Q"),N=r("8j5Y");let P=(()=>{class e{constructor(e,t,r,i){this.apQuery=e,this.apService=t,this.isamApi=r,this.exApi=i}resolve(){return 0===this.apQuery.getCount()?(this.setAttributeProviderApAuthId(Object(k.v4)()),this.getApDisplayName()):Object(w.a)(!0)}setAttributeProviderApAuthId(e){this.apService.setAttributeProviderApAuthId(e)}getApDisplayName(){return this.exApi.getAttributeProviderDisplayName("tdif_business_authorisations").pipe(Object(N.a)(e=>{console.debug("response in getApDisplayName response.properties.displayName",e.properties.displayName),this.apService.setAttributeProviderName(e.properties.displayName)}))}}return e.\u0275fac=function(t){return new(t||e)(m.Zb(d.a),m.Zb(d.b),m.Zb(o.d),m.Zb(o.a))},e.\u0275prov=m.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),j=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Jb({type:e,selectors:[["exchange-attribute-provider-shell"]],decls:1,vars:0,template:function(e,t){1&e&&m.Qb(0,"app-generic-redirect")},directives:[y.a],styles:[""]}),e})();var Q=r("XzLU");let S=(()=>{class e{constructor(e,t,r,i){this.route=e,this.config=t,this.rpQuery=r,this.title=i,this.redirectName=this.rpQuery.displayName,this.route.queryParams.subscribe(e=>{this.title.setTitle(`Returning to ${this.redirectName}`),this.externalRedirect(this.generateCancelUrl(e.context).href)})}externalRedirect(e){Object(b.a)(this.config.redirectTimeout).subscribe(()=>{Object(Q.k)(),window.location.href=e})}generateCancelUrl(e){const t=new URL(this.rpQuery.redirectUri);return t.searchParams.append("error",e),t.searchParams.append("state",this.rpQuery.state),t}}return e.\u0275fac=function(t){return new(t||e)(m.Pb(a.a),m.Pb(p.b),m.Pb(d.k),m.Pb(l.c))},e.\u0275cmp=m.Jb({type:e,selectors:[["exchange-choose-idp-cancel"]],decls:1,vars:1,consts:[[3,"name"]],template:function(e,t){1&e&&m.Qb(0,"app-generic-redirect",0),2&e&&m.mc("name",t.redirectName)},directives:[y.a],styles:[""]}),e})();const O=[{path:"",component:j,resolve:{entry:(()=>{class e{constructor(e,t,r){this.rpQuery=e,this.flowService=t,this.navigation=r}resolve(e,t){return this.initiateChooseBusinessSelection()}initiateChooseBusinessSelection(){return this.checkScope("tdif_business_authorisations").pipe(Object(N.a)(()=>{this.navigateFrom(u.a.ChooseBusiness)}))}checkScope(e){return this.rpQuery.hasScope(e)?(this.flowService.updateAp("selection",h.k.Required),Object(w.a)(!0)):(this.flowService.updateAp("selection",h.k.NotRequired),Object(w.a)(!1))}navigateFrom(e){this.navigation.resolveNavigation(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Zb(d.k),m.Zb(u.f),m.Zb(u.g))},e.\u0275prov=m.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},pathMatch:"full"},{path:"selection",component:g,canActivate:[A,c.e],resolve:{business:P},pathMatch:"full"},{path:"cancel",component:S,pathMatch:"full"}];let I=(()=>{class e{}return e.\u0275mod=m.Nb({type:e}),e.\u0275inj=m.Mb({factory:function(t){return new(t||e)},imports:[[a.g.forChild(O)],a.g]}),e})(),x=(()=>{class e{}return e.\u0275mod=m.Nb({type:e}),e.\u0275inj=m.Mb({factory:function(t){return new(t||e)},imports:[[i.c,s.a,n.a,I]]}),e})()}}]);